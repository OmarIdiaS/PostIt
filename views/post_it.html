{% extends "base.html" %}

{% block title %}Post_it{% endblock %}

{% block head %} 
    <link rel="stylesheet" href="public/style.css"> 
    

{% endblock %}

{% block main %}
<script>
  {% for d in donn %}
 
   

    JSON.parse(document.getElementById({{d.id}}).onclick = alert("oui"));
    

 console.log({{d.id}});
   
  {% endfor %}
   

</script>

<body id="post_it"> 
<table>
  <tr>
  <td>Welcome {{current}}</td>
    </tr>
  
<table>

{% for d in donn %}
  <tr>
    <td>{{ d.login }}</td>
    <td>{{d.txt}}</td>
    <td>{{d.coor}}</td>
    <td>{{d.id}}</td>
    <td>{{d.useer}}</td>
    <td><img id="{{d.id}}" src="https://cdn.glitch.com/e7146dd9-331b-4c07-9d68-fd24547f0732%2Fsuppr-ConvertImage.png?1554507094885"/></td>

  </tr>
{% endfor %}
  
</table>
  
  <script>
  
 document.getElementById("post_it").ondblclick = function() {myfunction()};
 
   // JSON.parse(document.getElementById(16).onclick = function() { s()});
   // JSON.parse(document.getElementById(17).onclick = function() { s()});
  //document.getElementById("{{d.id}}").onclick = function() { suppression()}; 
 
 function s(){alert("oui");}
 /*function suppression(){
  
    
    var xhr = new XMLHttpRequest();
    var url = "https://responsible-justice.glitch.me/suppr";
    

   
    xhr.onreadystatechange = function () {
      if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
        var json = JSON.stringify(xhr.responseText);
        alert('oui');
        window.location.reload();
      }
    };
   
   xhr.open("POST", url, true); 
 //  var data = { login: "", txt : "10/4/2019 7:48", coor : "X :327 Y :191", id = 15};
  xhr.setRequestHeader("Content-Type", "application/json");
 // xhr.send(JSON.stringify(data));
      xhr.send();
   
  }*/
    
 function myfunction() {
   
   // Coordonnees
    var x = event.clientX ; 
	  var y = event.clientY; 
	  var coor = "X :" + x + " Y :"  + y ;
  
   // Date
   var d = new Date(); 
	
	var j = d.getDate(); 
	var mois = d.getMonth() + 1; 
	var annee = d.getFullYear(); 
	var h = d.getHours(); 
	var m = d.getMinutes();
   var date = j+"/"+mois+"/"+annee+"  "+h+":"+m ; 
   
   //TEXTE
   
   var texte = prompt("Saisir votre texte ::");
   
    var xhr = new XMLHttpRequest();
    var url = "/p";
    xhr.open("POST", url, true); 

   
    xhr.onreadystatechange = function () {
      if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
        var json = JSON.stringify(xhr.responseText);
        alert("les donnees sont envoyer a la BD");
        window.location.reload();
      }
    };
  
  var data = { login: texte, txt : date, coor : coor};
  xhr.setRequestHeader("Content-Type", "application/json");
  xhr.send(JSON.stringify(data));
  console.log('okk');
   
 }
    
    
    
  
  var width=100;
 var difference=2;
 var interveralID =0;
 //document.getElementById("img1").style.width=width;
 
 function increase()
 {
 clearInterval(interveralID);
 interveralID=setInterval(expand,10);
 }
 function decrease()
 {
 clearInterval(interveralID);
 interveralID=setInterval(shrink,10);
 }
 function expand()
 {
 if(width<200)
 {
 width = width+difference;
 document.getElementById("imgg").style.width=width;
 console.log(width);
 }
 else
 {
 clearInterval(interveralID);
 }
 
 }
 function shrink()
 {
 if(width>100)
 {
 width = width-difference;
 document.getElementById("imgg").style.width=width;
 console.log(width);
 }
 else
 {
 clearInterval(interveralID);
 }
 
 }
  
</script>
  
 <!-- <div>
    {% for d in donn %}
    <p> {{ d.login }}</p>
    <p> {{ d.txt }}</p>
    <p> {{ d.coor }}</p>
    {% endfor %}
  </div>-->
  
  
  <div class="message">
  {{ message }}
</div>
</body>
{% endblock %}